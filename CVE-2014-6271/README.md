## Qmail SMTP - Bash Environment Variable Injection (CVE-2014-6271)

This module exploits a shellshock vulnerability on Qmail, a public domain MTA written in C that runs on Unix systems. Due to the lack of validation on the MAIL FROM field, it is possible to execute shell code on a system with a vulnerable BASH (Shellshock).
This flaw works on the latest Qmail versions (qmail-1.03 and netqmail-1.06). However, in order to execute code, /bin/sh has to be linked to bash(usually default configuration) and a valid recipient must be set on the RCPT TO field (usually admin@exampledomain.com)
The exploit does not work on the "qmailrocks" community version as it ensures the MAILFROM field is well-formed.


# Run the Exploit 
 - Update RHOST & MAILTO with your addresses
 - Update the ShellCode, you can generate it using msfvenom -p linux/x64/shell_bind_tcp LHOST=127.0.0.1 LPORT=443 -f py b '\x00\x0a\x0d' -e x86/shikata_ga_nai
 - to run: python Qmail-SMTP-Exploit.py
 - If the exploit succeds, you should see Port 443 open on the victim server as i used Bind shell. Feel free to modify it to use what ever you want. 
